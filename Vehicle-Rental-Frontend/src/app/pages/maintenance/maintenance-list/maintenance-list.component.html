<div class="container mx-24 p-4">
    <div class="mb-2">
        <button (click)="openMaintenanceModal()" class="border border-gray-600 hover:bg-white hover:text-black py-2 px-3 rounded-lg">
            Add Vehicle
        </button>
    </div>
    <div *ngIf="isLoading" class="text-center">Loading bookings...</div>

    <div class="mx-14 bg-gray-400 rounded-lg mt-10 overflow-x-auto overflow-y-auto" *ngIf="!isLoading && maintenances.length > 0">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
            
            <ng-container matColumnDef="vehicle_name">
            <th mat-header-cell *matHeaderCellDef>Vehicle Name</th>
            <td mat-cell *matCellDef="let element">{{element.vehicle_name}}</td>
            </ng-container>

            <ng-container matColumnDef="maintenance_date">
            <th mat-header-cell *matHeaderCellDef>Maintenance Date</th>
            <td mat-cell *matCellDef="let element">{{element.maintenance_date | date:'mediumDate'}}</td>
            </ng-container>

            <ng-container matColumnDef="maintenance_status">
            <th mat-header-cell *matHeaderCellDef>Status</th>
            <td mat-cell *matCellDef="let element">{{element.status}}</td>
            </ng-container>

            <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef>Action</th>
                <td mat-cell *matCellDef="let element">
                    <div class="buttons flex space-x-4 justify-items-center">
                        <button
                            *ngIf="element.status != 'Completed'"
                            class="p-1 border border-gray-500 rounded-lg hover:bg-blue-500 hover:text-white"
                            (click)="openMaintenanceModal(element)"
                        >
                            <img width="25" height="25" src="https://img.icons8.com/carbon-copy/100/create-new.png" alt="create-new"/>
                        </button>
                        <button
                            class="px-2 py-1 border border-gray-500 rounded-lg hover:bg-red-500 hover:text-white"
                            (click)="element.id ? deleteMaintenance(element.id) : null"
                        >
                            <img width="20" height="20" src="https://img.icons8.com/ios/50/delete-trash.png" alt="delete-trash"/>
                        </button>
                    </div>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="openMaintenanceDetails(row)"></tr>
        </table>
    </div>

    <div *ngIf="!isLoading && maintenances.length === 0" class="mx-24 text-center py-4">
        No Records found.
    </div>
    <app-maintenance-form
        *ngIf="maintenanceModalOpened"
        [maintenance] = "selectedMaintenance!"
        (close) = "closeMaintenanceModal($event)"
    >
    </app-maintenance-form>
</div>
