<div class="booking-list-container p-6">
    <h2 class="text-2xl font-bold mb-4 px-14">Booking List</h2>
    <div *ngIf="isLoading" class="text-center">Loading bookings...</div>
    <div class="mx-24 bg-gray-400 rounded-lg mt-12 overflow-x-auto overflow-y-auto" *ngIf="!isLoading && bookings.length > 0">
        <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
            
            <ng-container matColumnDef="user_name" *ngIf="authService.isAdmin()">
            <th mat-header-cell *matHeaderCellDef>User Name</th>
            <td mat-cell *matCellDef="let element" (click)="openBookingDetails(element)" style="cursor: pointer;">{{element.user_name}}</td>
            </ng-container>

            <ng-container matColumnDef="vehicle_id" *ngIf="authService.isAdmin()">
            <th mat-header-cell *matHeaderCellDef>Vehicle ID</th>
            <td mat-cell *matCellDef="let element">{{element.vehicle_id}}</td>
            </ng-container>

            <ng-container matColumnDef="booking_id" *ngIf="authService.isCustomer()">
            <th mat-header-cell *matHeaderCellDef>Booking ID</th>
            <td mat-cell *matCellDef="let element" (click)="openBookingDetails(element)" style="cursor: pointer;">{{element.id}}</td>
            </ng-container>

            <ng-container matColumnDef="vehicle_name" *ngIf="authService.isCustomer()">
            <th mat-header-cell *matHeaderCellDef>Vehicle Name</th>
            <td mat-cell *matCellDef="let element">{{element.vehicle_name}}</td>
            </ng-container>

            <ng-container matColumnDef="start_date">
            <th mat-header-cell *matHeaderCellDef>Start Date</th>
            <td mat-cell *matCellDef="let element">{{element.start_date | date:'mediumDate'}}</td>
            </ng-container>

            <ng-container matColumnDef="end_date">
            <th mat-header-cell *matHeaderCellDef>End Date</th>
            <td mat-cell *matCellDef="let element">{{element.end_date | date:'mediumDate'}}</td>
            </ng-container>

            <ng-container matColumnDef="action" *ngIf="authService.isCustomer()">
                <th mat-header-cell *matHeaderCellDef>Action</th>
                <td mat-cell *matCellDef="let element">
                    <div class="buttons flex space-x-4 justify-items-center" *ngIf="authService.isCustomer()">
                        <button
                            class="p-1 border border-gray-500 rounded-lg hover:bg-blue-500 hover:text-white"
                            (click)="openEditBookingModal(element)"
                        >
                            <img width="25" height="25" src="https://img.icons8.com/carbon-copy/100/create-new.png" alt="create-new"/>
                        </button>
                        <button
                            class="p-1 border border-gray-500 rounded-lg hover:bg-red-500 hover:text-white"
                            (click)="element.id ? deleteBooking(element.id) : null"
                        >
                            <img width="20" height="20" src="https://img.icons8.com/ios/50/delete-trash.png" alt="delete-trash"/>
                        </button>
                    </div>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </div>

    <div *ngIf="!isLoading && bookings.length === 0" class="mx-24 text-center py-4">
        No bookings found.
    </div>

    <app-edit-booking-modal
        *ngIf="bookingModalOpened && selectedBooking && selectedVehicle"
        [booking]="selectedBooking"
        [vehicle]="selectedVehicle"
        (close)="closeEditBookingModal($event)"
    ></app-edit-booking-modal>
</div>
